<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Lavish Barber Shop - Loyalty</title>
<style>
  body {
    margin:0;
    font-family:'Segoe UI', sans-serif;
    background:#0b0b0b;
    color:white;
    display:flex;
    flex-direction:column;
    align-items:center;
    justify-content:flex-start;
    text-align:center;
  }

  h1 { margin-top:30px; font-size:38px; }
  h3 { margin-bottom:20px; font-weight:300; }

  .input-group { margin:10px 0; display:flex; flex-direction:column; align-items:center; }
  input { padding:10px; font-size:16px; border-radius:6px; border:none; width:250px; margin-top:5px; }

  .progress-container {
    width:90%;
    max-width:400px;
    background:#222;
    border-radius:12px;
    overflow:hidden;
    margin:30px 0;
    height:30px;
  }

  .progress-bar {
    width:0%;
    height:100%;
    background:#00ff88;
    transition:width 0.5s;
  }

  .progress-text {
    margin-top:10px;
    font-size:20px;
    font-weight:bold;
    color:#00ff88;
  }

  button {
    margin-top:20px;
    padding:12px 25px;
    font-size:18px;
    background:#00ff88;
    border:none;
    border-radius:8px;
    cursor:pointer;
    font-weight:bold;
  }

  button:hover { background:#00cc66; }
</style>
</head>
<body>

<h1>ðŸ’ˆ Lavish Barber Shop</h1>
<h3>Loyalty Program</h3>

<div id="registerForm">
  <div class="input-group">
    <label for="name">Name:</label>
    <input type="text" id="name" placeholder="Enter your name">
  </div>
  <div class="input-group">
    <label for="phone">Phone Number:</label>
    <input type="text" id="phone" placeholder="Enter your phone">
  </div>
  <button onclick="registerClient()">Register</button>
</div>

<div id="loyalty" style="display:none;">
  <div class="progress-container">
    <div class="progress-bar" id="progressBar"></div>
  </div>
  <div class="progress-text" id="progressText">0 / 10 Haircuts</div>
  <button onclick="registerCut()">Register Haircut</button>
</div>

<script>
const maxCuts = 10;
// Lat/Lng aproximados de la barberÃ­a
const shopLat = 31.8457; // Cambia a tu latitud exacta
const shopLng = -102.3676; // Cambia a tu longitud exacta
const allowedDistance = 0.01; // Distancia en grados aprox (~1km)

// Registrar cliente
function registerClient(){
  const name = document.getElementById('name').value.trim();
  const phone = document.getElementById('phone').value.trim();
  if(!name || !phone){ alert("Please enter name and phone"); return; }

  // Guardar cliente en localStorage
  const clientKey = 'lavish_' + phone;
  if(!localStorage.getItem(clientKey)){
    localStorage.setItem(clientKey, JSON.stringify({name:name, cuts:0}));
  }

  localStorage.setItem('currentClient', clientKey);
  document.getElementById('registerForm').style.display='none';
  document.getElementById('loyalty').style.display='block';
  loadProgress();
}

// Cargar progreso del cliente actual
function loadProgress(){
  const clientKey = localStorage.getItem('currentClient');
  if(!clientKey) return;
  const data = JSON.parse(localStorage.getItem(clientKey));
  const cuts = data.cuts || 0;
  document.getElementById('progressBar').style.width = (cuts/maxCuts*100)+'%';
  document.getElementById('progressText').innerText = cuts+' / '+maxCuts+' Haircuts';
}

// Registrar corte con GPS
function registerCut(){
  if(!navigator.geolocation){
    alert("Geolocation not supported");
    return;
  }

  navigator.geolocation.getCurrentPosition(position => {
    const lat = position.coords.latitude;
    const lng = position.coords.longitude;
    const distance = Math.sqrt((lat-shopLat)**2 + (lng-shopLng)**2);
    if(distance > allowedDistance){
      alert("You must be at Lavish Barber Shop to register a haircut.");
      return;
    }

    const clientKey = localStorage.getItem('currentClient');
    let data = JSON.parse(localStorage.getItem(clientKey));
    data.cuts = (data.cuts || 0) +1;

    if(data.cuts >= maxCuts){
      alert("ðŸŽ‰ Free haircut unlocked!");
      data.cuts = 0;
    }

    localStorage.setItem(clientKey, JSON.stringify(data));
    loadProgress();
  }, err => {
    alert("Could not get your location.");
  });
}

// Si el cliente ya estaba registrado
window.onload = () => {
  const clientKey = localStorage.getItem('currentClient');
  if(clientKey){
    document.getElementById('registerForm').style.display='none';
    document.getElementById('loyalty').style.display='block';
    loadProgress();
  }
};
</script>

</body>
</html>
